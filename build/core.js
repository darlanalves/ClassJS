/*
 WhappJS
 Built on 2013-04-09
*/

(function(){"use strict";var t=function(){},n={}.hasOwnProperty,e=Array.prototype.slice,s=Object.prototype.toString;t.apply=function(t,e,s){var r;if(s=Boolean(s)||!1)for(r in e)n.call(e,r)&&(t[r]=e[r]);else for(r in e)t[r]=e[r];return t},t.extend=function(n){var s,r,i=e.call(arguments,1);for(s=0,r=i.length;r>s;s++)t.apply(n,i[s]);return n};var r={},i={};t.isArray=Array.isArray||function(t){return"[object Array]"===s.call(t)},t.isObject=function(t){return t===Object(t)},t.isFunction=function(t){return"[object Function]"===s.call(t)},t.isString=function(t){return"[object String]"===s.call(t)},t.isNumber=function(t){return"[object Number]"===s.call(t)},t.use=function(){var t,n,s,i,o,a,h,l,c;for(n=isArray(n)?n[0]:e.call(arguments),s=0,i=n.length,l={};i>s;)if(c=window,o=n[s],t=o.replace("/","."),a=t.split("."),r[t])l[a.pop()]=r[t];else{for(;0!==a.length;)if(h=a.shift(),c=c[h],void 0===c)throw Error("Class "+t+" not found!");useCache[t]=c,l[h]=c,s+=1}return l},t.namespace=function(n,e){var s,r,o,a,h;if(a=window,void 0!==i[n])a=i[n];else{if(h=n.split("."),0!==h.length)for(s=0,o=h.length;o>s;)r=h[s],a=a[r]||(a[r]={}),s+=1;i[n]=a}return t.isFunction(e)&&e.call(a),a},this.Whapp=t}).call(this),function(){({}).hasOwnProperty,[].slice,this.Class=function(){this.constructor.apply(this,arguments)},this.Class.prototype={config:{},constructor:function(){return this},$self:function(){return this.self},getPrototypeChain:function(t){var n,e=[],s=this.$self(),r=Whapp.ClassManager.superName;for(s&&(this[t]!=s[t]&&e.unshift(this[t]),__hasOwn.call(s,t)&&e.unshift(s[t])),n=this.superclass;n;)n&&__hasOwn.call(n,t)&&e.unshift(n[t]),n=n[r];return e},getMergedWithParents:function(t,n){var e,s,r,i,o;if(e=this.getPrototypeChain(t),n=1==Boolean(n),r=null,e.length){if(o=__last(e),__isArray(o))s=!1,r=[];else{if(!__isObject(o))return o;s=!0,r={}}for(;i=e.shift();)s&&i?_.extend(r,i):i.length&&(r=r.concat(i));s&&n&&(r=__clone(r))}return r},initConfig:function(t){var n,e,s,r,i,o;if(!this.$configInited){s=this,r=_.extend({},this.config,t),o=this.config,i=function(t){var n,e,r,i;return n=t+"",n=n.substr(0,1).toUpperCase()+n.substr(1).toLowerCase(),r=t,i="set"+n,e="get"+n,s[i]||(s[i]=function(t){return this[r]=t,this}),s[e]||(s[e]=function(){return this[r]}),!0};for(n in o)__hasProp.call(o,n)&&(e=o[n],i(n));this.config=r,_.extend(this,r),this.$configInited=!0}return this}},this.Class.uuid=function(){var t,n,e,s,r,i,o,a,h,l;for(s=[],n="0123456789ABCDEF",e=function(){for(l=[],r=0;35>=r;r++)l.push(r);return l}.apply(this),i=0,a=e.length;a>i;i++)t=e[i],s[t]=Math.floor(16*Math.random());for(s[14]=4,s[19]=8|3&s[19],o=0,h=e.length;h>o;o++)t=e[o],s[t]=n[s[t]];return s[8]=s[13]=s[18]=s[23]="-",s.join("")}}.call(Whapp),function(){var t=({}.hasOwnProperty,function(t){return Whapp.ClassManager.$cache[t]||Whapp.namespace(t)||null}),n={$cache:{},superName:"__super__",define:function(n,e){var s,r,i,o,a,h;if(o=n.split("."),s=o.pop(),a=o.length>1?Whapp.namespace(o.join(".")):window,e||(e={}),e&&e.extend){if(i=Whapp.isString(e.extend)?t(e.extend):e.extend,delete e.extend,i&&i.__final===!0)throw Error("Cannot extend final class: "+n)}else i=Whapp.Class;h={},Whapp.isObject(e.statics)&&(Whapp.apply(h,e.statics),delete e.statics),Whapp.isArray(e.consts)&&(Whapp.apply(h,Whapp.ClassManager.consts(e.consts)),delete e.consts),Whapp.apply(e,{$class:n,$name:s,$owner:a,$parent:i.prototype.$class||null}),r=Whapp.ClassManager.extend(i,e,h),Whapp.ClassManager.$cache[n]=r,a[s]=r},extend:function(t,e,s){var r,i;return r=function(){return this.constructor.apply(this,arguments)},_.extend(r,t,s),i=function(){},i.prototype=t.prototype,r.prototype=new i,_.extend(r.prototype,e),r.prototype[n.superName]=t.prototype,r.prototype.self=r,r.prototype.callParent=function(t){var e,s=n.superName;if(hasOwnProperty.call(this,t))e=this;else for(e=this[s];e&&!hasOwnProperty.call(s,t);)e=e[s];e[s]&&e[s][t]&&console.log(e[s][t],this[s])},r},create:function(n,e){var s=t(n);if(s)return new s(e);throw Error("Class not found: "+n)},resolve:function(n){return t(n)},consts:function(t){var n,e,s,r;for(e={},s=0,r=t.length;r>s;s++)n=t[s],_.isString(n)&&(e[n]=n);return e}};Whapp.ClassManager=n,Whapp.define=n.define}.call(this),function(){var t,n=[].slice;Whapp.namespace("Whapp.EventManager"),Whapp.define("Whapp.EventManager",{pauseEvents:!1,addListener:function(){var e,s,r,i,o,a,h;for(o=arguments[0],e=arguments[1],r=arguments[2],h=arguments.length>=4?n.call(arguments,3):[],!e||!_.isFunction(e),o=o.split(t),s=this._callbacks||(this._callbacks={});i=o.shift();)a=s[i]||(s[i]=[]),a.push({callback:e,context:r||this,params:h});return this},removeListener:function(n,e,s){var r,i,o,a,h;for(!(r=this._callbacks),n||e||s||delete this._callbacks,n=n.split(t),h=[];i=n.shift();)h.push(function(){var t,n;t=this._callbacks[i],n=[];for(a in t)o=t[a],e&&e===a.callback?n.push(delete this._callbacks[i][o]):n.push(delete this._callbacks[i]);return n}.call(this));return h},trigger:function(){var e,s,r,i,o,a,h,l,c,u;for(i=arguments[0],h=arguments.length>=2?n.call(arguments,1):[],this.pauseEvents||!(s=this._callbacks),i?(i=i.split(t),i.push("all")):i=["all"],l=!0;r=i.shift();)if(o=s[r])for(c=0,u=o.length;u>c&&(a=o[c],e=[],a.params.length&&(e=e.concat(a.params)),h.length&&(e=e.concat(h)),l=l&&a.callback.apply(a.context,e),l!==!1);c++);return l},clearListeners:function(n){var e,s,r;if(!(e=this._callbacks))return this;for(n?(n=n.split(t),n.push("all")):n=["all"],r=[];s=n.shift();)e[s]&&e[s].length?r.push(e[s]=[]):r.push(void 0);return r},once:function(t,n,e){var s,r,i=this,o=!1;return e=e||this,s=function(){i.removeListener(t,r,e),n.apply(this,arguments)},r=function(){o||(o=!0,s.apply(this,arguments),s=null)},this.on(t,r,e),this},on:function(){this.addListener.apply(this,arguments)},off:function(){this.removeListener.apply(this,arguments)},suspendEvents:function(){return this.pauseEvents=!0,this},resumeEvents:function(){return this.pauseEvents=!1,this}}),t=Whapp.EventManager.eventSplitter=/\s+|,\s?/}(),Whapp.define("Whapp.view.HookManager",{constructor:function(){this.hooks={before:[],after:[]}},callHooks:function(t,n,e){var s,r,i,o=this.hooks[t];if(n=n||[],e=e||this,o.length)for(s=0,r=o.length;r>s;s++)if(i=o[s].apply(e,n),i===!1)return i},clear:function(t){this.hooks[t]=[]},clearAll:function(){this.hooks.before=this.hooks.after=[]},push:function(t,n){this.hooks[t].push(n)},getHookedMethod:function(t,n){var e=this;return function(){e.callHooks("before",arguments,n);var s=t.apply(n,arguments);return e.callHooks("after",arguments,n),s}}}),function(){var t={}.hasOwnProperty;Whapp.define("Whapp.Component",{extend:"Whapp.EventManager",destroy:function(){return this.clearListeners(),this.destroyed=!0},hookBefore:function(t,n){this.hook(t,"before",n)},hookAfter:function(t,n){this.hook(t,"after",n)},hook:function(t,n,e){if(!_.isFunction(this[t]))throw Error("Trying to hook on a invalid method: "+t);if(!_.isFunction(e))throw Error("Tried to hook a invalid callback!");this.$hooks||(this.$hooks={}),this[t].$hooked||this.addHooks(t),this.$hooks[t].push(n,e)},addHooks:function(t){var n=this[t];this.$hooks[t]=new Moovia.view.HookManager,this[t]=this.$hooks[t].getHookedMethod(n,this),this[t].$hooked=!0},blocked:!1,block:function(){return this.destroyed?!1:(this.suspendEvents(),this.blocked=!0,this)},unblock:function(){return this.destroyed?!1:(this.resumeEvents(),this.blocked=!1,this)},setDisabled:function(t){return t=void 0!==t?Boolean(t):!0,t?this.block():this.unblock(),this},$id:null,getId:function(){var t=1e3;return function(){return this.$id||(this.$id="component-"+ ++t),this.$id}}(),getPrototypeChain:function(n){var e,s=[],r=this.$self();for(r&&(this[n]!=r[n]&&s.unshift(this[n]),t.call(r,n)&&s.unshift(r[n])),e=this.superclass;e;)e&&t.call(e,n)&&s.unshift(e[n]),e=e.superclass;return s},getMergedWithParents:function(t,n){var e,s,r,i,o;if(e=this.getPrototypeChain(t),n=1==Boolean(n),r=null,e.length){if(o=_.last(e),_.isArray(o))s=!1,r=[];else{if(!_.isObject(o))return o;s=!0,r={}}for(;;)if(i=e.shift(),s&&i?_.extend(r,i):i.length&&(r=r.concat(i)),0==e.length)break;s&&n&&(r=_.clone(r))}return r}})}.call(this);